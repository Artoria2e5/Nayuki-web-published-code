# 
# This program tests all the implementations of cryptographic ciphers.
# Run with no arguments. For Python 2 and 3.
# 
# Copyright (c) 2015 Project Nayuki
# http://www.nayuki.io/page/cryptographic-primitives-in-plain-python
# 
# (MIT License)
# Permission is hereby granted, free of charge, to any person obtaining a copy of
# this software and associated documentation files (the "Software"), to deal in
# the Software without restriction, including without limitation the rights to
# use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
# the Software, and to permit persons to whom the Software is furnished to do so,
# subject to the following conditions:
# - The above copyright notice and this permission notice shall be included in
#   all copies or substantial portions of the Software.
# - The Software is provided "as is", without warranty of any kind, express or
#   implied, including but not limited to the warranties of merchantability,
#   fitness for a particular purpose and noninfringement. In no event shall the
#   authors or copyright holders be liable for any claim, damages or other
#   liability, whether in an action of contract, tort or otherwise, arising from,
#   out of or in connection with the Software or the use or other dealings in the
#   Software.
# 

from cryptocommon import hexstr_to_bytelist


# ---- Main program ----

def main():
	test_aes_cipher()
	test_des_cipher()
	test_tea_cipher()
	print("All {} test cases passed".format(num_test_cases))


# ---- Test suite functions ----

def test_aes_cipher():
	print("Testing AES cipher...")
	import aescipher
	test_cipher(aescipher.encrypt, aescipher.decrypt, [
		("00000000000000000000000000000000", "00000000000000000000000000000000", "66E94BD4EF8A2C3B884CFA59CA342B2E"),
		("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", "FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", "BCBF217CB280CF30B2517052193AB979"),
		("3243F6A8885A308D313198A2E0370734", "2B7E151628AED2A6ABF7158809CF4F3C", "3925841D02DC09FBDC118597196A0B32"),
		("00112233445566778899AABBCCDDEEFF", "000102030405060708090A0B0C0D0E0F", "69C4E0D86A7B0430D8CDB78070B4C55A"),
		("12DDD706F27C2EB8D062EDC3CFA2E121", "CDBA764CA0DD93EF8B3859462B0DB38E", "9116061956F006252368393722FC5303"),
		("D9B47B9458D35A5F6CCD1813AF56AFD2", "5F0AA61051F65CC42FDC88B4D6A86995", "303D92288AA619A836DE528F053C42CE"),
		("BC134CBA0D00A4533C948C38A687862E", "AC65575FCF739B02F41C7153002E90DE", "8CDA460418CC4A5F4C9EB1DA59E594DB"),
		("13524045DB68498203A7A2416F487B2A", "E4BA3C11B0511691EF5B435A779BC12B", "F232DCD245D2106C0343D93A38269FD9"),
		("FF5BC9D0F6025BCAE45F3FAED4BE0DEB", "EAB439B86578E8169D4AC934A9AB7622", "D77CA8F6073B0A5E52D3D4007216D4E1"),
		("55D146D0DF562C435D1741B41915794D", "B13C64C83BA048A4E0D88670BB719287", "01BE0D90C29054D47803EFC413C5296C"),
		("7BFFBB57EDE979B2C1154E3D59CCE407", "5323F8F3E5886BA25C2F8C0AECB82BFD", "52E76F43CD267129BC85FF9C196EDDDB"),
		("86FC1F9BBBA80EF16BEB7B10DC24B81C", "8A7FECF79BAADAAC480E66CB8B39322D", "D1CF81A0EF841E676EA511AA744E5432"),
		("347C35F097FEE60AE66D73EDE83BAB6A", "741EA24348A8AE29B9B552120396DD7B", "77D10D937B66251EA0703240AE5001F6"),
		("0CA42D83CEA71123755085C4B092E502", "A9B02F6DB2AA8F3948E4369F51B3603F", "577644EB9E8C9BF925356E9BE7F218CD"),
		("73BB87D0D5358743834C21917F57C4C4", "C4236B8E921B525D8DB111E564BBB7E9", "BBC91909AE4B25A79BB2B94DB8837361"),
		("33B100FDDB32DDD7AB447377A250E5BE", "171C05AD79A5D757B9E97A8EBF4A25BA", "0C941BA64061247650D072AF2FF32B31"),
		("F2EC4A79E5E08B1EE808AFC4DF160D4C", "4A9C9533C1B052B286D850EAF679146D", "2260CEB3E7AAE4DB5296547B2F06A116"),
		("F0940CD399C5BBADB2A2A1F7E004554E", "2D855C83B46ACE9504DE016AB2924972", "F92CD000EAAFE9E7ADDBCD3945FEC3AB"),
		("9535E0AAC544DE90BFDDCB69E5606D46", "3CCA33363F75D397348AFF290462B4C1", "ADF86221BE552D463B4B89B5C479E06F"),
		("E01751B0C7ADA2821DB0E33AD33D093D", "6707EEDA3348D43AEB3F4CF7DAD78841", "4E4EFA06EC553DC1D491603DB2712CA0"),
		("AFB66C734DF2120DE745ADB3A6449C5F", "91BF3A20FD3A12177EC8C5CA51C24A82", "36DBC73D55AA60416D8D08675C69A2F5"),
		("9020DBF42A331DEBB64D76A9333178B7", "911E5C6BC40236F197B9443A92240960", "8730E093E06B42F62ACCDB3720236883"),
		("4F2AC3720DB161F3BFCF57DB40D7E94F", "F8CB708BBDC653C41993A4DCD57166F2", "467BF5E8C3C99582D10B399F82A670D2"),
		("C6CC2874A88BD47EFBE08BC04B0447B5", "D0B8BF2D590B5DD17769409C7FB068E7", "5600478C34ED96BC00ABF08C95E5481E"),
		("00000000000000000000000000000004", "00000000000000000000000000000000", "200211214E7394DA2089B6ACD093ABE0"),
		("00000000000000000000000000000000", "00000000000000010000000000000000", "F6B7BDD1CAEEBAB574683893C4475484"),
		("00000000000000000000000000000000", "00000000000000010000000000000000", "F6B7BDD1CAEEBAB574683893C4475484"),
		("00000000000000000000000000000000", "00000000000000020000000000000000", "5C76002BC7206560EFE550C80B8F12CC"),
		("00000000000000400000000000000000", "00000000000000000000000000000000", "DAA9B25168CC702326F217F1A0C0B162"),
		("00000000000000000000000000000000", "00000000000010000000000000000000", "04C67DBF16C11427D507A455DE2C9BC5"),
		("00000000000000000000000000000000", "08000000000000000000000000000000", "9AA042C315F94CBB97B62202F83358F5"),
		("00000000000000000000000000000000", "00000000000001000000000000000000", "CE24E4D40C68A82B535CBD3C8E21652A"),
		("00000040000000000000000000000000", "00000000000000000000000000000000", "7D03BA451371591D3FD5547D9165C73B"),
		("00000000000000000000200000000000", "00000000000000000000000000000000", "7975A57A425CDF5AA1FA929101F650B0"),
		("00000000000008000000000000000000", "00000000100000000000000000000000", "2EE94783255643A77CC52D1E9B4C5412"),
		("00000000000000000000000000000000", "00800000000000000000000000000001", "58F871B539D58BD6097A1E1DE387659F"),
		("00000010000000100000000000000000", "00000000000000000000000000000000", "E69D4F312CE1857818374B218F0467FB"),
		("00000000000000004000000000000000", "00000000000000000002000000000000", "24C5B8D40BC417FC80834736743CC533"),
		("00000000000000020000000000000000", "01000000000000000000000000000000", "364F7DEECD6D378365050EFFC451EE34"),
		("00000002000008000000000000000000", "00000000000000000000000000000000", "1E4F374F3478CDC108D3C91D7B0D6522"),
		("00000000000000000810000000000000", "00000000000000000000000000000000", "7E24618F3E1B695508ECD51BD4459B73"),
		("00000000000000000000000000000100", "00000100000000000000000000000000", "2E41AC7F4EAFECC5809759E56316148B"),
		("00000000000000000000000000000000", "00000000002000000000100000000000", "A73FBE40066B0773EA42FD8DBD6B4F7A"),
		("00000002000000000000020000000000", "00000000000000000000000000000000", "5B75AFE751444F4DBC19E27E3F769AB1"),
		("00000000000000000000000000010000", "00000002000000000000000000000000", "E71F0EF80C5E3F0EFF13850CD3B566F2"),
		("00000000000008000000000800000000", "00000000000000000000000000000000", "2C8A6855EDB818A50E8FDA64DD21BF97"),
		("00000000000000000000000000000000", "00000100001000000000000000000000", "11B0E4E946421F4DB1B940A194125509"),
		("00000008000000100000000000000000", "00000000000000000000000000000000", "C3AB50AE151354FBF5D991140AB8CDFA"),
		("00000000000000000000000000000000", "00001020000000000000000000000000", "E3B4510E71A43E10806834B4CC0EF5BF"),
		("00000000000000000000000000000000", "00000000000010000000000010000000", "FB4952ED20E2BEF0C45739F1FC323D44"),
		("00000000000000000000000000000000", "00000001000000000000004000000000", "4F4F10464D1295938B4A04D0061226D5"),
		("00010000000000000000000000000000", "00000000000000000000000000200000", "DC6B1D02727E32488E1013EC4E6D0DE5"),
		("04000000000000000001000000000000", "00000000000000000000000000000000", "11CEF6A5FECC4E9391DF122E4B16EBAE"),
		("08000000000080000000000000000000", "00000000000000000000000000000000", "CD588BCD9C423DD402929808239FB54E"),
		("00000000000002000000000004000001", "00000000000000000000000000000000", "D883376CB811F8964FD87EFE31B7ED23"),
		("00000000000000000000000000000000", "00000000000000000040000000024000", "83A10F5271FFD053641E9607738AF522"),
		("00800000000000000000000000000040", "00000000000000000000000000000002", "FB4DBBE7D1D38200848172A192AD4FF3"),
		("04000000000000000000000000000002", "00000000000100000000000000000000", "BCB40A52A37DF190270DA8A159B0C565"),
		("00004000000100000000000000002000", "00000000000000000000000000000000", "86487734134E6DAD6BA629C123EBA843"),
		("00000000000000000000000000000010", "01000000000000000000000000000001", "F05B1FACD8BA878611CCAED4CA65ABD7"),
		("00000000001000000000000000000001", "00000000000000010000000000000000", "4FC0040B265EF8BAC233462F826E18C3"),
		("00000000000000000000000000000000", "00000000002004000000000000020000", "6C41ECB21D924D5A53FBF89822C60EA5"),
		("20000000000000000000000000000000", "04000000000400000000000000000000", "86EFFC0A943A669524C0899B42FE07C6"),
		("00008000000000000000000000000000", "00000000080000000001000000000000", "0FAB1547FE7E51107871DD1984F19E31"),
		("00000000000000000000000000008000", "00000001000000000020000000000000", "C7306C2F20C4C6FD69D7450FAE17A3C3"),
		("00000000000000000000000000100000", "00000000000000004000000000010000", "68D118A1E670A8D720836DCA98544F1B"),
		("00000000000040000010000000000000", "00000000000000000000000000040000", "24DE4D17E49E7DE0B95EC3D43190DDE0"),
		("00000400000000000000000004002000", "00000000000000000000000000000000", "3826F610CFEBA5334FC3C4C8C1220015"),
		("00000000000000000008000000000000", "00000000000000000000240000000000", "2947A64E5630239E055254598E5C6AC7"),
		("00080000000000001000000000000000", "00100000000000000000000000000000", "4BFDF97C5819B3415B81C9E43DFE0A3F"),
		("00000000000040000000000000000000", "00000000000000000000010800000000", "B6097F1BB34CF1BE84F9FC0FFC839356"),
		("00001000000000000000000000000000", "00000000000000400000000000020000", "77933B7CEABDE68D07779886D58B2136"),
		("00000000001000000000000000000000", "00000000000000000000000000000300", "9039EEB150134C3EA2F481EDA185F238"),
		("00000000000000100000000200000000", "00000000000000000200000000000000", "7A555E42DE798CB8560541681F48EED6"),
		("20000000000000000000000000000000", "00000000000010000000000000000004", "C1F8628A9AA657C4B3B5B41452A00772"),
		("00001000000000000000000000000000", "00000000000000002001000000000000", "0DA35F67BC4B929C6B182B8CFEF1C6C2"),
		("00000008000000000000000000200000", "00000008000000000000000000000000", "0493188B2841BE2A9D3DDE3FB6075A6F"),
		("00000000004000000000000000000100", "00000000000000000000001000000000", "C1479EF7C169916BE1D8D611C7DC1152"),
		("00000200000000000000200000000000", "00000100000000000000000000000000", "E68F4A2092FC99D8F3861A27107043D6"),
		("00000000001000000000000000000000", "00000002000080000000000000000000", "045020306D48555D93C16A24FD88A16A"),
		("00040000000000000000000000000000", "00000000000800000000000000020000", "5C6DC6B2ACF46E99A9A63597BF202D76"),
		("00000400000000010000000000000000", "00000000000000000000000000100000", "B72D1D82DF30BE1732801618B2DD2877"),
		("08000000000000000000200800000000", "00000000000000000000000000000000", "6E6B46993AD88E379CA368CED75D5374"),
		("00020000000000000000000000000000", "00000000000040000000000001000000", "1DF223D602D5009C2949BC6AC24CA58B"),
		("00000000400000000002000000000000", "40000000000000000000000000000040", "DB6F8130881E03A20EA91002AF19DA1A"),
		("00000200080000000000000000000000", "01000000000000000000000000000002", "5C73696AAB62237EB29EF830C737FCF4"),
		("00000000000000000000000100000000", "40000000000000080400000000000000", "4564175E80C989E1663238B40AAF18AB"),
		("00800000000000000000000001000000", "00000000000000020000000000000040", "66BD9812ED9004D58C0E13D39981BC35"),
		("00000000000000008000000000000000", "01000100000000008000000000000000", "0EFDEB62556BF4A99CCAD7DABD9D993D"),
		("00800000000000000000000000000000", "00010000200000000000000400000000", "8B6251BAE22B33F4DEC1D04833EAC0C5"),
		("00000000000000000020010000000000", "00000000000000000040000000004000", "E19461C671DDCB20FC94CEFA62D812D4"),
		("00000000000000008110000000000000", "00000000000000000000000008000000", "056E2A6AFCD5CA79BC6007C79CA07567"),
		("00004000020000000000000000000000", "80000000000000000200000000000000", "FF542BD567421D6D5C014B9E0A8F0485"),
		("08000000000000000000000000000000", "40000000000000000000000000004040", "ED2F500989018A2D34902E53B22EE3C5"),
		("00000000000000020400000000000000", "20800000000000000000000000000000", "B8DC53595224ED00B7B31F308828483E"),
		("02020000000000000000000000080000", "00000000000000000000000000100000", "045E3128879CFDA6F8D07E6DB69DF877"),
		("00000000000000000000000000000000", "00800001000000000000000000200001", "B9042377A90997D4812417472F8EB674"),
		("00000000400000000000400000000000", "00000000000000200004000000000000", "DA4577A3548E3811E65E43D816F4B166"),
		("00001000000000000000000002000000", "00100200000000000000000000000000", "9F8E9344921F1E6EFEBE22C6210D737F"),
		("00000000000000000000008000200000", "00400000000000000000000000800000", "4ADD27446DEF8B617581BD7B589898AF"),
		("00000000000000000000100000000020", "80000000000000000000080000000000", "1FAE2E4D7E4CBC2F047B4B8686AEB81B"),
		("00000004000000000000000000000000", "00020000000000002000000000000001", "7CF73CC3662254E01CC54FE08216FD75"),
		("00000000000000800000000000000000", "00000010000000000001040000000000", "5CA455607D7A1B03418723506A0A3157"),
		("80000000000000000000000000000000", "04000000000010100000000000000000", "71A73AB3DD37C27E68F4FBDBE97BA1D2"),
		("00000000000000000000000000002000", "00000000000000000000400000000005", "E991CA4A9244BF85FB4A46BBC5A1B912"),
		("00000010000020000000080000000000", "02000000000000000000000000000000", "2184791DC5706F2BDE2A98CDBC034ABF"),
		("00040000000024000000000000000000", "08000000000000000000000000000000", "440FE6DA538FDEE7B24C198262480250"),
		("02000000000000000000000000000000", "02000000000000080000000000000040", "D28FEB52D4878297DFD8CC224B8B7670"),
		("00000000004000000000000800000000", "00000010000000000000000100000000", "D35C72FC08ADB9930B8789C81FF0D9D6"),
		("00000000000040000000000000000000", "00200000000000200000004000000000", "E6F54FEAF9B03C63391CFB5B7E5339C5"),
		("00400000000000000000000000000000", "00004000040000040000000000000000", "FD908C40D4DE0611B5821BEB4EE067E4"),
		("00000800000000000010000000000000", "00000000000040000400000000000000", "136216F734AE123C43A4985347BF1390"),
		("00000000001000000000000000000000", "10000000000000000000080200000000", "2698AF3AA97969058021C1D36EC60DCA"),
		("00000000000040002000000000000000", "00010000000000000000000000000020", "C54E55827FA18DAA246B134F4A02E3AE"),
		("00000000000000000000080000000000", "40000000000001000000000002000000", "79A5CDC4582CC123592C830C0221AFA3"),
		("00000000000000000000002000000040", "00000000000000040400000000000000", "D7FE21611FE4586456EFD1519B27C728"),
		("00000400000000000000000000000000", "00000001200000000000000000200000", "21FF1BDA97052663C8DBEAD47762FB72"),
		("00200000008000000000000000000000", "00000000000004000000000000004000", "FCDAF8F67B1019CBEEF142837AF7AA3F"),
		("00000000000000000000000000000000", "00000020000000000000000002080010", "BB1E21537483A7B2D4F815116DA718F3"),
		("00000000000000000000000000000000", "00040000000000040000000021000000", "92D84FF74F379535DDF737D3BE222702"),
		("00200000000000000010000000000000", "00000000000000020000000000100000", "3E6FCB779B1A405D3A6D15542381BE81"),
		("00000000000000000000002000000000", "00400000001010000000000000000000", "B4321818C54551F2DA3D6D9F10AFEC2E"),
		("01000000000200100000000000000000", "00000000000000000400000000000000", "0C0CFA1D312B1252EBFF0E57E328FDBA"),
		("00100000100010000000000000000000", "00000000000000008000000000000000", "F659CE96D13E8B19904BF83A6C6BB501"),
	])


def test_des_cipher():
	print("Testing DES cipher...")
	import descipher
	test_cipher(descipher.encrypt, descipher.decrypt, [
		("0000000000000000", "0000000000000000", "8CA64DE9C1B123A7"),
		("FFFFFFFFFFFFFFFF", "FFFFFFFFFFFFFFFF", "7359B2163E4EDC58"),
		("1122334455667788", "752878397493CB70", "B5219EE81AA7499D"),
		("99AABBCCDDEEFF00", "752878397493CB70", "2196687E13973856"),
		("0000000000000000", "10316E028C8F3B4A", "82DCBAFBDEAB6602"),
		("8000000000000000", "0101010101010101", "95F8A5E5DD31D900"),
		("4000000000000000", "0101010101010101", "DD7F121CA5015619"),
		("2000000000000000", "0101010101010101", "2E8653104F3834EA"),
		("1000000000000000", "0101010101010101", "4BD388FF6CD81D4F"),
		("0800000000000000", "0101010101010101", "20B9E767B2FB1456"),
		("0400000000000000", "0101010101010101", "55579380D77138EF"),
		("0200000000000000", "0101010101010101", "6CC5DEFAAF04512F"),
		("0100000000000000", "0101010101010101", "0D9F279BA5D87260"),
		("0080000000000000", "0101010101010101", "D9031B0271BD5A0A"),
		("0040000000000000", "0101010101010101", "424250B37C3DD951"),
		("0020000000000000", "0101010101010101", "B8061B7ECD9A21E5"),
		("0010000000000000", "0101010101010101", "F15D0F286B65BD28"),
		("0008000000000000", "0101010101010101", "ADD0CC8D6E5DEBA1"),
		("0004000000000000", "0101010101010101", "E6D5F82752AD63D1"),
		("0002000000000000", "0101010101010101", "ECBFE3BD3F591A5E"),
		("0001000000000000", "0101010101010101", "F356834379D165CD"),
		("0000800000000000", "0101010101010101", "2B9F982F20037FA9"),
		("0000400000000000", "0101010101010101", "889DE068A16F0BE6"),
		("0000200000000000", "0101010101010101", "E19E275D846A1298"),
		("0000100000000000", "0101010101010101", "329A8ED523D71AEC"),
		("0000080000000000", "0101010101010101", "E7FCE22557D23C97"),
		("0000040000000000", "0101010101010101", "12A9F5817FF2D65D"),
		("0000020000000000", "0101010101010101", "A484C3AD38DC9C19"),
		("0000010000000000", "0101010101010101", "FBE00A8A1EF8AD72"),
		("0000008000000000", "0101010101010101", "750D079407521363"),
		("0000004000000000", "0101010101010101", "64FEED9C724C2FAF"),
		("0000002000000000", "0101010101010101", "F02B263B328E2B60"),
		("0000001000000000", "0101010101010101", "9D64555A9A10B852"),
		("0000000800000000", "0101010101010101", "D106FF0BED5255D7"),
		("0000000400000000", "0101010101010101", "E1652C6B138C64A5"),
		("0000000200000000", "0101010101010101", "E428581186EC8F46"),
		("0000000100000000", "0101010101010101", "AEB5F5EDE22D1A36"),
		("0000000080000000", "0101010101010101", "E943D7568AEC0C5C"),
		("0000000040000000", "0101010101010101", "DF98C8276F54B04B"),
		("0000000020000000", "0101010101010101", "B160E4680F6C696F"),
		("0000000010000000", "0101010101010101", "FA0752B07D9C4AB8"),
		("0000000008000000", "0101010101010101", "CA3A2B036DBC8502"),
		("0000000004000000", "0101010101010101", "5E0905517BB59BCF"),
		("0000000002000000", "0101010101010101", "814EEB3B91D90726"),
		("0000000001000000", "0101010101010101", "4D49DB1532919C9F"),
		("0000000000800000", "0101010101010101", "25EB5FC3F8CF0621"),
		("0000000000400000", "0101010101010101", "AB6A20C0620D1C6F"),
		("0000000000200000", "0101010101010101", "79E90DBC98F92CCA"),
		("0000000000100000", "0101010101010101", "866ECEDD8072BB0E"),
		("0000000000080000", "0101010101010101", "8B54536F2F3E64A8"),
		("0000000000040000", "0101010101010101", "EA51D3975595B86B"),
		("0000000000020000", "0101010101010101", "CAFFC6AC4542DE31"),
		("0000000000010000", "0101010101010101", "8DD45A2DDF90796C"),
		("0000000000008000", "0101010101010101", "1029D55E880EC2D0"),
		("0000000000004000", "0101010101010101", "5D86CB23639DBEA9"),
		("0000000000002000", "0101010101010101", "1D1CA853AE7C0C5F"),
		("0000000000001000", "0101010101010101", "CE332329248F3228"),
		("0000000000000800", "0101010101010101", "8405D1ABE24FB942"),
		("0000000000000400", "0101010101010101", "E643D78090CA4207"),
		("0000000000000200", "0101010101010101", "48221B9937748A23"),
		("0000000000000100", "0101010101010101", "DD7C0BBD61FAFD54"),
		("0000000000000080", "0101010101010101", "2FBC291A570DB5C4"),
		("0000000000000040", "0101010101010101", "E07C30D7E4E26E12"),
		("0000000000000020", "0101010101010101", "0953E2258E8E90A1"),
		("0000000000000010", "0101010101010101", "5B711BC4CEEBF2EE"),
		("0000000000000008", "0101010101010101", "CC083F1E6D9E85F6"),
		("0000000000000004", "0101010101010101", "D2FD8867D50D2DFE"),
		("0000000000000002", "0101010101010101", "06E7EA22CE92708F"),
		("0000000000000001", "0101010101010101", "166B40B44ABA4BD6"),
		("0000000000000000", "8001010101010101", "95A8D72813DAA94D"),
		("0000000000000000", "4001010101010101", "0EEC1487DD8C26D5"),
		("0000000000000000", "2001010101010101", "7AD16FFB79C45926"),
		("0000000000000000", "1001010101010101", "D3746294CA6A6CF3"),
		("0000000000000000", "0801010101010101", "809F5F873C1FD761"),
		("0000000000000000", "0401010101010101", "C02FAFFEC989D1FC"),
		("0000000000000000", "0201010101010101", "4615AA1D33E72F10"),
		("0000000000000000", "0180010101010101", "2055123350C00858"),
		("0000000000000000", "0140010101010101", "DF3B99D6577397C8"),
		("0000000000000000", "0120010101010101", "31FE17369B5288C9"),
		("0000000000000000", "0110010101010101", "DFDD3CC64DAE1642"),
		("0000000000000000", "0108010101010101", "178C83CE2B399D94"),
		("0000000000000000", "0104010101010101", "50F636324A9B7F80"),
		("0000000000000000", "0102010101010101", "A8468EE3BC18F06D"),
		("0000000000000000", "0101800101010101", "A2DC9E92FD3CDE92"),
		("0000000000000000", "0101400101010101", "CAC09F797D031287"),
		("0000000000000000", "0101200101010101", "90BA680B22AEB525"),
		("0000000000000000", "0101100101010101", "CE7A24F350E280B6"),
		("0000000000000000", "0101080101010101", "882BFF0AA01A0B87"),
		("0000000000000000", "0101040101010101", "25610288924511C2"),
		("0000000000000000", "0101020101010101", "C71516C29C75D170"),
		("0000000000000000", "0101018001010101", "5199C29A52C9F059"),
		("0000000000000000", "0101014001010101", "C22F0A294A71F29F"),
		("0000000000000000", "0101012001010101", "EE371483714C02EA"),
		("0000000000000000", "0101011001010101", "A81FBD448F9E522F"),
		("0000000000000000", "0101010801010101", "4F644C92E192DFED"),
		("0000000000000000", "0101010401010101", "1AFA9A66A6DF92AE"),
		("0000000000000000", "0101010201010101", "B3C1CC715CB879D8"),
		("0000000000000000", "0101010180010101", "19D032E64AB0BD8B"),
		("0000000000000000", "0101010140010101", "3CFAA7A7DC8720DC"),
		("0000000000000000", "0101010120010101", "B7265F7F447AC6F3"),
		("0000000000000000", "0101010110010101", "9DB73B3C0D163F54"),
		("0000000000000000", "0101010108010101", "8181B65BABF4A975"),
		("0000000000000000", "0101010104010101", "93C9B64042EAA240"),
		("0000000000000000", "0101010102010101", "5570530829705592"),
		("0000000000000000", "0101010101800101", "8638809E878787A0"),
		("0000000000000000", "0101010101400101", "41B9A79AF79AC208"),
		("0000000000000000", "0101010101200101", "7A9BE42F2009A892"),
		("0000000000000000", "0101010101100101", "29038D56BA6D2745"),
		("0000000000000000", "0101010101080101", "5495C6ABF1E5DF51"),
		("0000000000000000", "0101010101040101", "AE13DBD561488933"),
		("0000000000000000", "0101010101020101", "024D1FFA8904E389"),
		("0000000000000000", "0101010101018001", "D1399712F99BF02E"),
		("0000000000000000", "0101010101014001", "14C1D7C1CFFEC79E"),
		("0000000000000000", "0101010101012001", "1DE5279DAE3BED6F"),
		("0000000000000000", "0101010101011001", "E941A33F85501303"),
		("0000000000000000", "0101010101010801", "DA99DBBC9A03F379"),
		("0000000000000000", "0101010101010401", "B7FC92F91D8E92E9"),
		("0000000000000000", "0101010101010201", "AE8E5CAA3CA04E85"),
		("0000000000000000", "0101010101010180", "9CC62DF43B6EED74"),
		("0000000000000000", "0101010101010140", "D863DBB5C59A91A0"),
		("0000000000000000", "0101010101010120", "A1AB2190545B91D7"),
		("0000000000000000", "0101010101010110", "0875041E64C570F7"),
		("0000000000000000", "0101010101010108", "5A594528BEBEF1CC"),
		("0000000000000000", "0101010101010104", "FCDB3291DE21F0C0"),
		("0000000000000000", "0101010101010102", "869EFD7F9F265A09"),
		("0000000000000000", "1046913489980131", "88D55E54F54C97B4"),
		("0000000000000000", "1007103489988020", "0C0CC00C83EA48FD"),
		("0000000000000000", "10071034C8980120", "83BC8EF3A6570183"),
		("0000000000000000", "1046103489988020", "DF725DCAD94EA2E9"),
		("0000000000000000", "1086911519190101", "E652B53B550BE8B0"),
		("0000000000000000", "1086911519580101", "AF527120C485CBB0"),
		("0000000000000000", "5107B01519580101", "0F04CE393DB926D5"),
		("0000000000000000", "1007B01519190101", "C9F00FFC74079067"),
		("0000000000000000", "3107915498080101", "7CFD82A593252B4E"),
		("0000000000000000", "3107919498080101", "CB49A2F9E91363E3"),
		("0000000000000000", "10079115B9080140", "00B588BE70D23F56"),
		("0000000000000000", "3107911598080140", "406A9A6AB43399AE"),
		("0000000000000000", "1007D01589980101", "6CB773611DCA9ADA"),
		("0000000000000000", "9107911589980101", "67FD21C17DBB5D70"),
		("0000000000000000", "9107D01589190101", "9592CB4110430787"),
		("0000000000000000", "1007D01598980120", "A6B7FF68A318DDD3"),
		("0000000000000000", "1007940498190101", "4D102196C914CA16"),
		("0000000000000000", "0107910491190401", "2DFA9F4573594965"),
		("0000000000000000", "0107910491190101", "B46604816C0E0774"),
		("0000000000000000", "0107940491190401", "6E7E6221A4F34E87"),
		("0000000000000000", "19079210981A0101", "AA85E74643233199"),
		("0000000000000000", "1007911998190801", "2E5A19DB4D1962D6"),
		("0000000000000000", "10079119981A0801", "23A866A809D30894"),
		("0000000000000000", "1007921098190101", "D812D961F017D320"),
		("0000000000000000", "100791159819010B", "055605816E58608F"),
		("0000000000000000", "1004801598190101", "ABD88E8B1B7716F1"),
		("0000000000000000", "1004801598190102", "537AC95BE69DA1E1"),
		("0000000000000000", "1004801598190108", "AED0F6AE3C25CDD8"),
		("0000000000000000", "1002911598100104", "B3E35A5EE53E7B8D"),
		("0000000000000000", "1002911598190104", "61C79C71921A2EF8"),
		("0000000000000000", "1002911598100201", "E2F5728F0995013C"),
		("0000000000000000", "1002911698100101", "1AEAC39A61F0A464"),
		("01A1D6D039776742", "7CA110454A1A6E57", "690F5B0D9A26939B"),
		("5CD54CA83DEF57DA", "0131D9619DC1376E", "7A389D10354BD271"),
		("0248D43806F67172", "07A1133E4A0B2686", "868EBB51CAB4599A"),
		("51454B582DDF440A", "3849674C2602319E", "7178876E01F19B2A"),
		("42FD443059577FA2", "04B915BA43FEB5B6", "AF37FB421F8C4095"),
		("059B5E0851CF143A", "0113B970FD34F2CE", "86A560F10EC6D85B"),
		("0756D8E0774761D2", "0170F175468FB5E6", "0CD3DA020021DC09"),
		("762514B829BF486A", "43297FAD38E373FE", "EA676B2CB7DB2B7A"),
		("3BDD119049372802", "07A7137045DA2A16", "DFD64A815CAF1A0F"),
		("26955F6835AF609A", "04689104C2FD3B2F", "5C513C9C4886C088"),
		("164D5E404F275232", "37D06BB516CB7546", "0A2AEEAE3FF4AB77"),
		("6B056E18759F5CCA", "1F08260D1AC2465E", "EF1BF03E5DFA575A"),
		("004BD6EF09176062", "584023641ABA6176", "88BF0DB6D70DEE56"),
		("480D39006EE762F2", "025816164629B007", "A1F9915541020B56"),
		("437540C8698F3CFA", "49793EBC79B3258F", "6FBF1CAFCFFD0556"),
		("072D43A077075292", "4FB05E1515AB73A7", "2F22E49BAB7CA1AC"),
		("02FE55778117F12A", "49E95D6D4CA229BF", "5A6B612CC26CCE4A"),
		("1D9D5C5018F728C2", "018310DC409B26D6", "5F4C038ED12B2E41"),
		("305532286D6F295A", "1C587F1C13924FEF", "63FAC0D034D9F793"),
	])


def test_tea_cipher():
	print("Testing TEA cipher...")
	import teacipher
	test_cipher(teacipher.encrypt, teacipher.decrypt, [
		("0000000000000000", "00000000000000000000000000000000", "41EA3A0A94BAA940"),
		("FFFFFFFFFFFFFFFF", "FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", "319BBEFB016ABDB2"),
		("0000000000000000", "00000000800000000000000000000000", "9327C49731B08BBE"),
		("0000000000000000", "80000000000000000000000000000000", "9327C49731B08BBE"),
		("0000000000000000", "80000000000000008000000080000000", "9327C49731B08BBE"),
		("0000000000000000", "00000000800000008000000080000000", "9327C49731B08BBE"),
		("A240C5B41E29C357", "2310C113A0166B5E13AFEA71B560CCBE", "725E20D1B8ABCBBB"),
		("9466CA33C5265EC8", "60876116E23C8971D3BBD1E706AF8E07", "02C2F412056067BE"),
		("04F2788F3870B7BB", "01CAB749C990AB430987C1BC704903E1", "43057258DF36A1E5"),
		("3C67FA25BF95E3EE", "90BAF6A8E42C66EE507522D26EC56D11", "4DFCC3CF59742B29"),
		("F27B904377FD4CC9", "C6C9B8DB52CA23D331169A6CDE5D30A5", "081A070917629473"),
		("7E749DFA332BA0F3", "B264304524C6E467E95EE184F22BC02A", "C885D1F8267591C6"),
		("6A63B55D2E1D1FFE", "DC31565DBD925F065351485B02535EDF", "FB3FD9B39E9558C7"),
		("DB5E7946917450F6", "DAF6277C11937ED3337B51B2804333D1", "03F37655EE63F07D"),
		("A6B3C4B1D54D4D7C", "B4514C9A3888FC5C2BA253E040C176C8", "4DB40FBAE132B052"),
		("56127B57D6B506FA", "D723D35EBA202DDE0373B1590EA94AD8", "CFC76A88C01C32A4"),
		("8839FF8F2EF892E5", "60903DC95AA15AB7C31F39888DC48F47", "F61629B5DBAACED8"),
		("4798B6849037F036", "0D9F2422118855B981A66F27D162E853", "D87168B8BB8AA3F3"),
		("E3414906705D1532", "28299D8798E1309C857DD91A2DF4B38A", "47B6AA80E73295A2"),
		("241F7ACF45DF0614", "C567C13D43635A664C59E9EFE3FB2BCD", "C5D2036CFD23AD70"),
		("0845F1C186A10FF5", "FB268153ACC08D4C088F438A153B8BC4", "E7A2BA6D6E2535E0"),
		("723E5EB753AA2D00", "6B3902A96D0E4095A120A5C79CC16100", "63767CDD69D106DC"),
		("D8E4590FA35D74A6", "2DD9369553188FBC1C3059CDF16F4844", "2A4113EC3A117F9A"),
		("327CA4FC7C447055", "73335A695E2A9C0A22BBB6B1E2F90202", "A0AFFBD3488E1FA6"),
		("377878A5C8A16EBF", "DA1546E2D0C1E391EE8577129863617A", "7EA5BE7ACD76F68E"),
		("EF550EBFD18BBBDB", "CC60B6EF9CC04BCC6552799AD8615CE8", "C8E33B3C45E11DE6"),
		("0000000040000000", "00000000000000000000000000000000", "D3CEE88F818622C4"),
		("0000000000000000", "00000000000000000800000000000000", "8217710F75D1EC9E"),
		("0000000000000000", "00000008000000000000000000000000", "65A876C07202FAF4"),
		("0000000000000000", "00000000000000004000000000000000", "76FBEC33247FAE1E"),
		("0000000000000000", "00000000000000000000000000400000", "36F1BF1828068CEC"),
		("0000000000000000", "00000000000000000000000000000002", "DEF21AEFB9E791BC"),
		("0000000000010000", "00000000000000000000000000000000", "8E0A303C90A7EFED"),
		("0000000000000000", "00000000000000000000000000008000", "FD7711E03883F332"),
		("0000000000000000", "00020000000000000000000000000000", "5E34D77E40C1C08E"),
		("0000000000000000", "00000000000000000100000000000000", "6B1C0E516C417FC3"),
		("0000000000000000", "01000000000000000100000000000000", "C669F8B39A776902"),
		("0020000000001000", "00000000000000000000000000000000", "D2511F10D08DA392"),
		("0000000000000000", "00020000020000000000000000000000", "98AB01852AD42624"),
		("0000000000000000", "00008800000000000000000000000000", "F3F85FA0A144D0F9"),
		("0080000000000000", "00000000000000000000000000010000", "7AFB50902B1B65EA"),
		("0000000000000000", "00000000004000000000002000000000", "AD13288341452F72"),
		("0000000000000000", "00400000000000000000000008000000", "C638C2A3F38EFFE5"),
		("0008000000000000", "00000000000008000000000000000000", "F66F939BF8E9B384"),
		("0000000000000240", "00000000000000000000000000000000", "37916A534B4BA39B"),
		("0000000000002000", "00000000000000000000000000000200", "C939E65D75A04801"),
		("0800000000000020", "00000000000000000000000000000000", "2ECE40AB2117DAEE"),
		("0000000000001000", "00040000000000000000000000000000", "579943FEA3DC8562"),
		("0000010000000000", "00000000000000000000000000000008", "09824904452DBBA7"),
		("0000000000000080", "00000000000000000000020000000000", "FDA811E66E30B50C"),
		("0000000080000000", "00004000000000000000000000000000", "E13D0BDBB27536FB"),
		("0000000000000000", "00000000000000000080000000000008", "FBD039A34F9BB296"),
		("0000000000000000", "00000000000000000000800000800000", "4F9E2F9B9891608B"),
		("0000000000000000", "00000002000000100000000000000000", "6942448727E80C57"),
		("0000000000000000", "40000100000000000000000000000000", "B281AB19E0212D28"),
		("0000000000000000", "00000000000020000100000000000000", "95C57E07CAB03245"),
		("0040000020400000", "00000000000000000000000000000000", "E8E40B17DF5FBC0A"),
		("0000000000000000", "00000080000000000008000000000010", "DDED8B5200BBAC48"),
		("0000004000000000", "08000000000000000000000001000000", "EDA161A8796501F9"),
		("0100000000000000", "00000400800000000000000000000000", "203F45F748CB7750"),
		("0000000000800000", "00000000280000000000000000000000", "B808FD68B5BB6034"),
		("0000000400000001", "00000000000000000000000000000004", "595B14247E3C44C1"),
		("0000000000000000", "00000000000080000080020000000000", "7D9F1A98571B9367"),
		("8000000000000000", "04000000000000000000000000000008", "71C3103A6E4E46D2"),
		("0000000000000000", "00000000000100000000020000100000", "88670F7ED55FA8BD"),
		("0000000000000000", "00000000000000000020000000080001", "E37E3DA11CF2D776"),
		("0000000000008000", "00800000000000000000010000000000", "5F9259ABB450498C"),
		("0002000000000000", "00000000000000000000004000100000", "2235C4FE08417193"),
		("0000000000080000", "00000000000000008000000000008000", "61D329360E7E115F"),
		("8000000000000000", "00000000100000020000000000000000", "845D68CF964BA906"),
		("0000000010000000", "00000000000000004000000000200000", "AB81C982CEFD7E7A"),
		("0000000000000001", "00000000400000008000000000000000", "45D93B5B146CD7A9"),
		("0008000000001000", "40000000000000000000000000000000", "C46318435DA76430"),
		("0000000000000000", "00000000000080000000000080000100", "EF2FD0D14A2FA6E2"),
		("0000000080000000", "00000400000000000000000000000004", "E47A01B2E6B08256"),
		("0004000000000000", "08000000000800000000000000000000", "4C3E4068FF502C0C"),
		("0000000000000000", "00000000000000001000001004000000", "1452646545C8DE14"),
		("0000000000008000", "00000010000000000000000000800000", "444EC47C65854613"),
		("0000000000000000", "00000800000000000800000000000004", "39813EB14E69BCC1"),
		("2000000000000020", "00000000000000000000000000100000", "E92CACE0CCFEBE5A"),
		("0000000000000000", "00000000040010000200000000000000", "CAA94656D21AE933"),
		("0000000008000020", "00000000000100000000000000000000", "5E8AEB3BCBAA4333"),
		("0000000000000000", "0000000000000080000000000C000000", "5B5CFCC246A2AC3D"),
		("0002000000000000", "00000000000000080002000000000000", "CFD83C42460DA917"),
		("0000001000000000", "00000000000004000000000080000000", "AA0A9E31EFA4CD8D"),
		("0000000000080000", "00000004000000000020000000000000", "2883176EF831C31F"),
		("0800000000000000", "0000C000000000000000100000000000", "27702FA57EA3BEF3"),
		("0000000000000200", "41010000000000000000000000000000", "EC6CE000DA8ADE91"),
		("0080000000000008", "00000000004000000004000000000000", "1BE4E6B3ADF48A04"),
		("0000000008400802", "00000000000000000000000000000000", "DC9CFFC3019ADEDF"),
		("0000000000040000", "00000000008100000000000000001000", "C61F7D600751D3C9"),
		("0000000020000040", "00000000000000000000000000011000", "7913770B244C7D05"),
		("0000000000280000", "00080000000000100000000000000000", "2CE665B942C5B87E"),
		("0000000000000000", "00000000000000204000024000000000", "9874C4432AA45BC3"),
		("4040000000000000", "00000000800000000000008000000000", "9BF9BED3F995CFBA"),
		("0000000000000100", "80100000000000000000020000000000", "EC772CC19526B1DF"),
		("0000000010000000", "00000000000020000000008800000000", "EFE7E0BDF6E5E10C"),
		("0000000000000006", "00000000000000808000000000000000", "3BDB15AE4738AEFF"),
		("0000002000000400", "00001000000000000000400000000000", "C79BEC2F3BDE775A"),
		("0000000000000000", "05000000002200000000000000000000", "C4786FF1FE657DCE"),
		("0000000000000000", "00000004000000000800000400080000", "C4D85589E7C013C8"),
		("0000000000000000", "00000000000000000100000104008000", "0A03454B740ED33D"),
		("0000000008020000", "00000000000001000000000020000000", "C2E1125AEEC567DC"),
		("0000000000000800", "00000000008000000001001000000000", "2590580CDA870DD8"),
		("000000000C000200", "00000000000000000000100000000000", "FE0E899841C93B44"),
		("0000000000001000", "00000000010400002000000000000000", "C3D8BD4E2D5C581E"),
		("0000000002000010", "00000000000000000200000080000000", "433C38A8F8B26059"),
		("0000000200000002", "02000000000000000000000004000000", "FB4601AB6D9E6BE7"),
		("0000000004000000", "04000000000400000400000000000000", "4E548587DEE729FF"),
		("0000000000000000", "00000000003000000800000000000002", "C0794C359F38D28B"),
		("0000000000002000", "00000000000000000000100048000000", "1E1CE779261C1CA0"),
		("0000000200000000", "00020800000000000000000000000002", "25A475D3A46FD4A1"),
		("0000000000020000", "00020000002001000000000000000000", "A2E53FB836D955C4"),
		("0000000000000000", "00000000001000100000010000040000", "D11DABE44D0D230A"),
		("4000000000000000", "00000800000000000000002000008000", "9BF19DCD333D4320"),
		("0008100000002000", "00000000000000000000100000000000", "7B7FE9288BF3DA54"),
		("0000000000002000", "00000000040000020000000000000010", "BE44D82BBB77BAE2"),
		("0000020000000001", "10000000000000000000080000000000", "8AD91ADEF81056ED"),
		("0000000000040200", "00000000000005000000000000000000", "4BD79D257199DE87"),
		("0000000000000000", "84020000000000000000000004000000", "CB3ABFCA403F821E"),
		("0008000002000000", "00008020000000000000000000000000", "07F00F7756D0676B"),
		("0000000000000000", "00000000080000000002000001200000", "DF1CBA6E28C52248"),
		("0000000000000000", "00000000000001880000400000000000", "1A31502485B74605"),
		("0000001000000000", "00000000000080800200000000000000", "817B9191B919FD38"),
		("0000000000000000", "00000000400240000000040000000000", "CDF58B5E1B4A4C35"),
		("0000100400000000", "00002000000000000000000000040000", "363EA0D57B72783F"),
	])


# ---- Private utilities ----

def test_cipher(encfunc, decfunc, cases):
	global num_test_cases
	assert type(cases) == list
	
	for (plaintexthex, keyhex, expectedciphertexthex) in cases:
		assert type(keyhex) == str
		assert type(plaintexthex) == str
		assert type(expectedciphertexthex) == str
		
		keybytelist = hexstr_to_bytelist(keyhex)
		plaintextbytelist = hexstr_to_bytelist(plaintexthex)
		actualciphertextbytelist = encfunc(plaintextbytelist, keybytelist)
		expectedciphertextbytelist = hexstr_to_bytelist(expectedciphertexthex)
		decryptedbytelist = decfunc(actualciphertextbytelist, keybytelist)
		
		assert type(actualciphertextbytelist) == list
		assert type(decryptedbytelist) == list
		if actualciphertextbytelist != expectedciphertextbytelist:
			raise AssertionError()
		if decryptedbytelist != plaintextbytelist:
			raise AssertionError()
		num_test_cases += 1


num_test_cases = 0


if __name__ == "__main__":
	main()
